name: Integrate Pull Request with Test

on:
  push:
	@@ -8,13 +8,20 @@ on:
    branches:
      - 'develop'
      - 'main'
    paths:
      - "feature/*"
    types:
      - auto_merge_enabled

permissions:
  checks: write
  contents: write
  pages: write
  deployments: write
  pull-requests: write

jobs:
  build-and-test:
    runs-on: ubuntu-latest

    steps:
	@@ -39,17 +46,18 @@ jobs:
      - name: Grant execute permission for gradlew
        run: chmod +x gradlew

      - name: Setup Python
        uses: actions/setup-python@v4
        with:
          python-version: 3.8

      - name: Build with Gradle
        run: ./gradlew build -x test

      - name: Test with Gradle
        run: ./gradlew test -Djasypt.encryptor.password=${{ secrets.APPLICATION_SECRET }}


      - name: Report Test Results
        uses: EnricoMi/publish-unit-test-result-action@v2
        if: always()
